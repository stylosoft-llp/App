(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{1029:function(t,e,n){"use strict";n.r(e);n(6),n(33),n(34),n(723);var r={layout:"superDesktop",data:function(){return{conversations:[],selectedConversation:null,newUser:null,keyword:"",users:[],loadingUsers:!1,messages:[],current_room:null}},components:{ChatWindow:function(){return Promise.resolve().then(n.bind(null,723))}},mounted:function(){this.fetchConversations()},watch:{keyword:function(t){t&&t.length>=2&&(this.loadingUsers=!0,this.fetchUsers())},newUser:function(t){t&&(this.withUser=t,this.startConversation())}},computed:{withUser:{get:function(){return this.$route.query.withUser},set:function(){this.$router.push({query:{withUser:this.newUser.id}})}}},methods:{fetchConversations:function(){var t=this;this.$axios.get("/auth/conversations").then((function(e){t.conversations=e.data}))},fetchUsers:function(){var t=this;this.loadingUsers=!0,this.$axios.get("/auth/users/filter?name"+this.keyword).then((function(e){t.loadingUsers=!1,t.users=e.data}))},startConversation:function(){var t=this;this.$axios.post("/auth/conversations",{user_id:this.newUser}).then((function(e){t.conversations.push(e.data),t.newUser=null,t.selectedConversation=e.data.id}))}}},o=n(27),c=n(31),l=n.n(c),d=n(555),h=n(505),m=n(210),v=n(515),f=n(750),_=n(728),w=n(511),y=n(729),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{row:"",container:""}},[n("v-col",{attrs:{md:"2.5"}},[n("v-list",{staticStyle:{background:"#f9fbfc",height:"100vh"}},t._l(t.conversations,(function(e,r){return n("v-list-item",{key:r,class:t.current_room==e.id&&"white",on:{click:function(n){t.current_room=e.id}}},[n("v-list-item-icon",[n("v-icon",{attrs:{large:""}},[t._v("mdi-account-circle")])],1),t._v(" "),n("v-list-item-content",[e.receiver&&e.sender?n("v-list-item-title",[t._v("\n\t\t\t\t\t\t"+t._s(e.sender.id==t.$auth.user.id?e.receiver.name:e.sender.name)+"\n\t\t\t\t\t")]):t._e(),t._v(" "),n("v-list-item-subtitle",[t._v("\n\t\t\t\t\t\t\t"+t._s(e.last_message)+"\n\t\t\t\t\t\t")])],1)],1)})),1)],1),t._v(" "),n("v-col",{attrs:{md:"9"}},[n("v-autocomplete",{attrs:{items:t.users,outlined:"",dense:"","item-text":"name","item-value":"id",loading:t.loadingUsers,"search-input":t.keyword,"hide-no-data":"",label:"Search User For New Chat"},on:{"update:searchInput":function(e){t.keyword=e},"update:search-input":function(e){t.keyword=e}},model:{value:t.newUser,callback:function(e){t.newUser=e},expression:"newUser"}}),t._v(" "),t.current_room?n("chat-window",{key:t.current_room,attrs:{current_room:t.current_room}}):t._e()],1)],1)}),[],!1,null,null,null);e.default=component.exports;l()(component,{VAutocomplete:d.a,VCol:h.a,VIcon:m.a,VLayout:v.a,VList:f.a,VListItem:_.a,VListItemContent:w.a,VListItemIcon:y.a,VListItemSubtitle:w.b,VListItemTitle:w.c})},723:function(t,e,n){"use strict";n.r(e);n(78),n(87),n(28),n(71);var r={props:["current_room"],data:function(){return{message:"",messages:[],currentUserId:1234}},mounted:function(){var t=this;this.getMessages(),setInterval((function(){t.getMessages()}),5e3)},methods:{getMessages:function(){var t=this;this.$axios.get("auth/conversations/".concat(this.current_room,"/messages")).then((function(e){t.$nextTick((function(){t.messages=e.data.data}))}))},sendMessage:function(){var t=this;this.$axios.post("auth/conversations/".concat(this.current_room,"/messages"),{message:this.stringified}).then((function(e){var n=t.messages;n.unshift(e.data),t.messages=n,t.message=""}),(function(t){}))},multiline:function(t){return t?t.split("\n").join("<br/>"):""}},computed:{stringified:function(){return JSON.parse(JSON.stringify(this.message))}}},o=n(27),c=n(31),l=n.n(c),d=n(494),h=n(211),m=n(515),v=n(504),f=n(554),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-layout",{attrs:{column:""}},[n("div",{staticClass:"px-2",attrs:{id:"chatBody"}},[n("div",{staticClass:"d-flex flex-row justify-top"},[n("v-textarea",{staticClass:"ma-2",attrs:{rows:"3","auto-grow":"",filled:"",color:"black","background-color":"amber lighten-4",label:"Your Message"},scopedSlots:t._u([{key:"append",fn:function(){return[n("v-btn",{staticClass:"ma-2",attrs:{large:"",color:"primary darken-2"},on:{click:function(e){return t.sendMessage()}}},[t._v("Send")])]},proxy:!0}]),model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1),t._v(" "),t._l(t.messages,(function(e,r){return n("v-card",{key:r,staticClass:"my-2 pa-2",class:e.from===t.$auth.user.id?"ml-auto teal lighten-4":"mr-auto ",staticStyle:{"max-width":"60%"}},[n("p",{domProps:{innerHTML:t._s(t.multiline(e.body))}}),t._v(" "),n("div",{staticClass:"d-flex font-italic body-2"},[n("b",[t._v(t._s(e.from===t.$auth.user.id?"Me":e.user_name))]),t._v(" "),n("v-spacer"),t._v(" "),n("span",{},[t._v(t._s(e.created_at&&new Date(e.created_at).toDateString()))])],1)])}))],2)])}),[],!1,null,null,null);e.default=component.exports;l()(component,{VBtn:d.a,VCard:h.a,VLayout:m.a,VSpacer:v.a,VTextarea:f.a})}}]);